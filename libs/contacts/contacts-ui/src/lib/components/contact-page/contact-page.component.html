<contacts-page-toolbar title="Contact" #toolbar>
  @if (toolbar.mode() === 'full') {
    <div class="flex gap-2">
      <a
        matButton="tonal"
        routerLink="/contacts"
        [queryParams]="{ tab: 'contacts' }"
        data-testid="close-button"
      >
        Close
      </a>
    </div>
  } @else {
    <div class="flex gap-2">
      <a
        mat-icon-button
        routerLink="/contacts"
        [queryParams]="{ tab: 'contacts' }"
        data-testid="close-button"
        aria-label="Close"
      >
        <mat-icon>close</mat-icon>
      </a>
    </div>
  }
</contacts-page-toolbar>

<div class="p-4">
  @if (contactToEdit()) {
  <contacts-form
    [contact]="contactToEdit()"
    [linkedIdentities]="linkedIdentities()"
    [startInEditMode]="startInEditMode()"
    (save)="onSave($event)"
  />

  @if (contactToEdit()?.id && groupsForContact().length > 0) {
  <div class="mt-6 p-4 border rounded-md bg-white">
    <h3 class="font-medium text-gray-700">Member of Groups:</h3>
    <div class="flex flex-wrap gap-2 mt-2">
      @for (group of groupsForContact(); track group.id.toString()) {
      <mat-chip-listbox aria-label="Group membership">
        <mat-chip data-testid="group-chip">
          {{ group.name }}
        </mat-chip>
      </mat-chip-listbox>
      }
    </div>
  </div>
  }
  } @else {
  <p>Loading contact details...</p>
  }
</div>