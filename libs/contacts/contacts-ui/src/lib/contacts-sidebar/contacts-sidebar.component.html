<div class="h-full flex flex-col bg-white">
  <contacts-page-toolbar [title]="title()" #toolbar>
    <div class="flex items-center gap-2">
      @if (showFilter()) {
        <lib-list-filter
          [(query)]="filterQuery"
          placeholder="Search contacts..."
          class="mr-2"
        />
      }
      @if (showAddActions()) {
        @if (toolbar.mode() === 'full') {
          <a
            mat-stroked-button
            color="primary"
            routerLink="."
            [queryParams]="{ new: 'contact' }"
            queryParamsHandling="merge"
            >New Contact</a
          >
          <a
            mat-stroked-button
            color="primary"
            routerLink="."
            [queryParams]="{ new: 'group' }"
            queryParamsHandling="merge"
            >New Group</a
          >
        } @else {
          <a
            mat-icon-button
            color="primary"
            routerLink="."
            [queryParams]="{ new: 'contact' }"
            queryParamsHandling="merge"
            ><mat-icon>person_add</mat-icon></a
          >
          <a
            mat-icon-button
            color="primary"
            routerLink="."
            [queryParams]="{ new: 'group' }"
            queryParamsHandling="merge"
            ><mat-icon>group_add</mat-icon></a
          >
        }
      }
    </div>
  </contacts-page-toolbar>

  <mat-tab-group
    class="mat-tab-icon-button flex-1 h-full overflow-hidden"
    animationDuration="0ms"
    [selectedIndex]="tabIndex()"
    (selectedTabChange)="onTabChange($event)"
  >
    <mat-tab label="Contacts">
      <div class="h-full overflow-y-auto pt-2">
        <contacts-list
          [contacts]="filteredContacts()"
          [selectedId]="selectedId()"
          (contactSelected)="contactSelected.emit($event)"
          (contactEditRequested)="contactEditRequested.emit($event)"
          (contactDeleted)="onDeleteContact($event)"
        />
      </div>
    </mat-tab>

    <mat-tab label="Groups">
      <div class="h-full overflow-y-auto pt-2">
        <contacts-group-list
          [groups]="filteredGroups()"
          [selectedId]="selectedId()"
          [badgeResolver]="badgeResolver()"
          (groupSelected)="groupSelected.emit($event)"
        />
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
