<div class="flex h-screen">
  <div class="w-full md:w-1/3 border-r overflow-y-auto">
    
    @switch (viewMode()) {
      
      @case ('conversations') {
        <chat-conversation-list
          [items]="conversationViewItems()"
          (conversationSelected)="onSelectConversation($event)"
        />
      }
      
      @case ('start_conversation') {
        <div class="p-4 text-center text-gray-500">
          <h3 class="font-bold text-lg">Start a new chat</h3>
          <p>Select a contact or group to begin.</p>
        </div>
        
        <div class="flex border-b border-t">
          <button
            (click)="startChatView.set('contacts')"
            [class.text-blue-600]="startChatView() === 'contacts'"
            [class.border-b-2]="startChatView() === 'contacts'"
            [class.border-blue-600]="startChatView() === 'contacts'"
            [class.text-gray-500]="startChatView() !== 'contacts'"
            class="flex-1 p-3 font-medium text-center hover:bg-gray-50"
          >
            Contacts
          </button>
          <button
            (click)="startChatView.set('groups')"
            [class.text-blue-600]="startChatView() === 'groups'"
            [class.border-b-2]="startChatView() === 'groups'"
            [class.border-blue-600]="startChatView() === 'groups'"
            [class.text-gray-500]="startChatView() !== 'groups'"
            class="flex-1 p-3 font-medium text-center hover:bg-gray-50"
          >
            Groups
          </button>
        </div>

        @if (startChatView() === 'contacts') {
          <contacts-list
            [contacts]="contacts()"
            (contactSelected)="onSelectContactToChat($event)"
          />
        } @else {
          <contacts-group-list
            [groups]="groups()"
            (groupSelected)="onSelectGroupToChat($event)"
          />
        }
      }
      
      @case ('new_user_welcome') {
        <div class="p-4 text-center text-gray-500 mt-10">
          <h3 class="font-bold text-lg">Welcome to Messenger</h3>
          <p>You don't have any contacts or conversations yet.</p>
          <a
            routerLink="/contacts"
            class="mt-4 inline-block bg-blue-600 text-white rounded-md p-2"
          >
            Add a Contact to get started
          </a>
        </div>
      }
    }

  </div>

  <div 
    class="hidden md:block md:w-2/3"
    [class.chat-window-mobile-active]="isChatActive()">
    <router-outlet />
  </div>
</div>