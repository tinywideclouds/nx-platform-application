syntax = "proto3";

package action_intention.envelope.v1;
option go_package = "github.com/illmade-knight/go-action-intention-protos/gen/go/sm/v1;sm_v1";

// Represents a single item in the encrypted message digest.
message EncryptedDigestItemPb {
  // The URN of the conversation (e.g., "urn:sm:user:..." or "urn:sm:group:...").
  string conversation_id = 1;

  // The encrypted blob containing digest information like sender alias,
  // message snippet, timestamp, etc. The client must decrypt this.
  bytes encrypted_snippet = 2;

  bytes encrypted_symmetric_key = 3;
  // Optional: You could include lightweight, *unencrypted* metadata here if needed,
  // but be very careful not to leak sensitive information.
  // For example, a timestamp of the latest message might be acceptable.
  // string latest_timestamp = 4; // Example, if needed and safe.

  // a switch to check github workflows - comment or uncomment to activate workflow
  bytes change_field = 4;
}

// A wrapper message for a list of encrypted digest items.
// This is the structure the API endpoint `/api/messages/digest` would return.
message EncryptedDigestPb {
  repeated EncryptedDigestItemPb items = 1;
}
