{
  "name": "auth-flow-e2e",
  "$schema": "../../../node_modules/nx/schemas/project-schema.json",
  "projectType": "application",
  "prefix": "app",
  "sourceRoot": "apps/messenger/auth-flow-e2e/src",
  "tags": ["scope:messenger"],
  "targets": {
    "test": {
      "executor": "nx:run-commands",
      "options": {
        "env": {
          "IDENTITY_SERVICE_URL": "http://localhost:3000",
          "JWT_SECRET": "a-secure-e2e-test-secret-that-is-not-the-default-really",
          "GCP_PROJECT_ID": "gemini-power-test"
        },
        "commands": [
          {
            "command": "npx concurrently --kill-others-on-fail --names \"NODE,GO,TEST\" -c \"auto\" \"npx nx serve node-identity-service\" \"npx wait-on http://localhost:3000/api/health-check && docker run --rm --network=host -e IDENTITY_SERVICE_URL=http://host.docker.internal:3000 -e JWT_SECRET -e GCP_PROJECT_ID -e GOOGLE_APPLICATION_CREDENTIALS=/tmp/adc.json -v \"C:\\Users\\tim\\AppData\\Roaming\\gcloud\\application_default_credentials.json\":/tmp/adc.json ghcr.io/tinywideclouds/go-key-service:latest\" \"npx wait-on http://localhost:3000/api/health-check http-get://localhost:8081/readyz && npx vitest run --config ./libs/messenger/chat-state/vitest.config.mts\""
          }
        ],
        "parallel": false
      }
    },
    "lint": {
      "executor": "@nx/eslint:lint"
    }
  }
}
